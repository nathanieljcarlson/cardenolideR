% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ID_cardenolides.R
\name{ID_cardenolides}
\alias{ID_cardenolides}
\title{Identify cardenolides from HPLC chromatograms}
\usage{
ID_cardenolides(
  input_dir = getwd(),
  output_dir = getwd(),
  format_in = "chemstation_uv",
  peak_lambda = 218,
  peak_range = c(216, 222),
  do_ptw = TRUE,
  do_baseline = FALSE,
  do_manual_verification = FALSE,
  minor_peak_max = 0.25,
  skip_auto_screen = FALSE,
  rt_range_min = 4,
  rt_range_max = 40,
  new_ts = seq(0.01, 39.95, by = 0.01),
  new_lambdas = seq(200, 318, by = 2),
  n_cores = 4
)
}
\arguments{
\item{input_dir}{Directory with raw chromatogram files}

\item{output_dir}{Directory to save CSV results}

\item{format_in}{Input chromatogram format (default "chemstation_uv")}

\item{peak_lambda}{Wavelength to focus on (default 218)}

\item{peak_range}{Range of absorbance maxima to filter candidate peaks (default 216-222)}

\item{do_ptw}{Whether to perform PTW retention time warping (default TRUE)}

\item{do_baseline}{Whether to perform baseline correction (default FALSE)}

\item{do_manual_verification}{Whether to manually verify peaks (default FALSE)}

\item{minor_peak_max}{Maximum size of minor peak (outside target lambda) for inclusion (default 0.25)}

\item{skip_auto_screen}{Skip automatic screening and go straight to manual (default FALSE)}

\item{rt_range_min}{Minimum retention time to consider (in minutes, default 0)}

\item{rt_range_max}{Maximum retention time to consider (in minutes, default 40)}

\item{new_ts}{Retention time sequence for preprocessing}

\item{new_lambdas}{Wavelength sequence for preprocessing}

\item{n_cores}{Number of CPU cores for parallel processing (default 4)}
}
\value{
A list containing:
  \itemize{
    \item all_peaks - data.frame of all detected peaks with sample IDs as row names
    \item auto_candidates - data.frame of automatically selected candidate peaks with sample IDs as row names
    \item final_peaks - data.frame of peaks identified as cardenolides with sample IDs as row names
    \item verified_df - manual verification data (if manual verification used)
    \item spectra_dir - directory containing exported HTML absorbance spectra
  }
}
\description{
Tools for detecting cardenolides or similar compounds from HPLC data.
}
\details{
Identify cardenolides from HPLC chromatograms

Reads chromatograms, preprocesses them, optionally performs PTW warping,
identifies candidate cardenolides based on absorption spectra, and allows
manual verification with notes. Exports CSV files and HTML absorbance spectra.
}
